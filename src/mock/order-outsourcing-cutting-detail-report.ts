import type {
  OutsourcingCuttingDetailListParams,
  OutsourcingCuttingDetailListResponse,
  OutsourcingCuttingDetailRecord,
} from '../types/order-outsourcing-cutting-detail-report';

const delay = (ms: number) => new Promise((resolve) => setTimeout(resolve, ms));

type DetailSeed = Omit<OutsourcingCuttingDetailRecord, 'amount'>;

const detailSeeds: DetailSeed[] = [
  {
    id: 'ocd-001',
    orderNumber: '202510080004',
    status: '未完成',
    subcontractor: '永春',
    styleNumber: 'CT0320',
    styleName: '成人撞色条纹直筒裤',
    color: '黑色',
    size: 'S',
    unitPrice: 8.8,
    cuttingDate: '2025-10-11',
    quantity: 36,
  },
  {
    id: 'ocd-002',
    orderNumber: '202510080004',
    status: '未完成',
    subcontractor: '永春',
    styleNumber: 'CT0320',
    styleName: '成人撞色条纹直筒裤',
    color: '黑色',
    size: 'M',
    unitPrice: 8.8,
    cuttingDate: '2025-10-11',
    quantity: 42,
  },
  {
    id: 'ocd-003',
    orderNumber: '202510080004',
    status: '进行中',
    subcontractor: '宏达制衣',
    styleNumber: 'CT0320',
    styleName: '成人撞色条纹直筒裤',
    color: '雾灰',
    size: 'L',
    unitPrice: 9.2,
    cuttingDate: '2025-10-12',
    quantity: 48,
  },
  {
    id: 'ocd-004',
    orderNumber: '202510080004',
    status: '进行中',
    subcontractor: '宏达制衣',
    styleNumber: 'CT0320',
    styleName: '成人撞色条纹直筒裤',
    color: '雾灰',
    size: 'XL',
    unitPrice: 9.2,
    cuttingDate: '2025-10-12',
    quantity: 45,
  },
  {
    id: 'ocd-005',
    orderNumber: '202510080018',
    status: '已完成',
    subcontractor: '诚旺服饰',
    styleNumber: 'JK5208',
    styleName: '青少年拼色运动外套',
    color: '曜石黑',
    size: '160/84A',
    unitPrice: 12.5,
    cuttingDate: '2025-09-28',
    quantity: 30,
  },
  {
    id: 'ocd-006',
    orderNumber: '202510080018',
    status: '已完成',
    subcontractor: '诚旺服饰',
    styleNumber: 'JK5208',
    styleName: '青少年拼色运动外套',
    color: '曜石黑',
    size: '165/88A',
    unitPrice: 12.5,
    cuttingDate: '2025-09-28',
    quantity: 28,
  },
  {
    id: 'ocd-007',
    orderNumber: '202510080018',
    status: '已完成',
    subcontractor: '诚旺服饰',
    styleNumber: 'JK5208',
    styleName: '青少年拼色运动外套',
    color: '宝石蓝',
    size: '160/84A',
    unitPrice: 12.5,
    cuttingDate: '2025-09-27',
    quantity: 32,
  },
  {
    id: 'ocd-008',
    orderNumber: '202510080018',
    status: '已完成',
    subcontractor: '诚旺服饰',
    styleNumber: 'JK5208',
    styleName: '青少年拼色运动外套',
    color: '宝石蓝',
    size: '165/88A',
    unitPrice: 12.5,
    cuttingDate: '2025-09-27',
    quantity: 30,
  },
  {
    id: 'ocd-009',
    orderNumber: '202510090012',
    status: '未完成',
    subcontractor: '尚品裁剪',
    styleNumber: 'PO6132',
    styleName: '城市轻机能套头衫',
    color: '钛空银',
    size: 'M',
    unitPrice: 10.8,
    cuttingDate: '2025-10-09',
    quantity: 44,
  },
  {
    id: 'ocd-010',
    orderNumber: '202510090012',
    status: '未完成',
    subcontractor: '尚品裁剪',
    styleNumber: 'PO6132',
    styleName: '城市轻机能套头衫',
    color: '钛空银',
    size: 'L',
    unitPrice: 10.8,
    cuttingDate: '2025-10-09',
    quantity: 46,
  },
  {
    id: 'ocd-011',
    orderNumber: '202510090012',
    status: '进行中',
    subcontractor: '尚品裁剪',
    styleNumber: 'PO6132',
    styleName: '城市轻机能套头衫',
    color: '云杉绿',
    size: 'M',
    unitPrice: 10.8,
    cuttingDate: '2025-10-10',
    quantity: 40,
  },
  {
    id: 'ocd-012',
    orderNumber: '202510090012',
    status: '进行中',
    subcontractor: '尚品裁剪',
    styleNumber: 'PO6132',
    styleName: '城市轻机能套头衫',
    color: '云杉绿',
    size: 'L',
    unitPrice: 10.8,
    cuttingDate: '2025-10-10',
    quantity: 42,
  },
  {
    id: 'ocd-013',
    orderNumber: '202510090030',
    status: '未开始',
    subcontractor: '金盛车缝',
    styleNumber: 'DW4185',
    styleName: '轻薄立领羽绒外套',
    color: '星际蓝',
    size: 'M',
    unitPrice: 15.6,
    cuttingDate: '2025-10-15',
    quantity: 38,
  },
  {
    id: 'ocd-014',
    orderNumber: '202510090030',
    status: '未开始',
    subcontractor: '金盛车缝',
    styleNumber: 'DW4185',
    styleName: '轻薄立领羽绒外套',
    color: '星际蓝',
    size: 'L',
    unitPrice: 15.6,
    cuttingDate: '2025-10-15',
    quantity: 40,
  },
  {
    id: 'ocd-015',
    orderNumber: '202510090030',
    status: '未开始',
    subcontractor: '金盛车缝',
    styleNumber: 'DW4185',
    styleName: '轻薄立领羽绒外套',
    color: '晨雾灰',
    size: 'M',
    unitPrice: 15.6,
    cuttingDate: '2025-10-16',
    quantity: 36,
  },
  {
    id: 'ocd-016',
    orderNumber: '202510090030',
    status: '未开始',
    subcontractor: '金盛车缝',
    styleNumber: 'DW4185',
    styleName: '轻薄立领羽绒外套',
    color: '晨雾灰',
    size: 'L',
    unitPrice: 15.6,
    cuttingDate: '2025-10-16',
    quantity: 34,
  },
  {
    id: 'ocd-017',
    orderNumber: '202510110021',
    status: '进行中',
    subcontractor: '宏达制衣',
    styleNumber: 'SK7251',
    styleName: '都市修身西装裙',
    color: '曜夜黑',
    size: 'S',
    unitPrice: 18.2,
    cuttingDate: '2025-10-13',
    quantity: 28,
  },
  {
    id: 'ocd-018',
    orderNumber: '202510110021',
    status: '进行中',
    subcontractor: '宏达制衣',
    styleNumber: 'SK7251',
    styleName: '都市修身西装裙',
    color: '曜夜黑',
    size: 'M',
    unitPrice: 18.2,
    cuttingDate: '2025-10-13',
    quantity: 32,
  },
  {
    id: 'ocd-019',
    orderNumber: '202510110021',
    status: '进行中',
    subcontractor: '宏达制衣',
    styleNumber: 'SK7251',
    styleName: '都市修身西装裙',
    color: '暮紫',
    size: 'S',
    unitPrice: 18.2,
    cuttingDate: '2025-10-14',
    quantity: 24,
  },
  {
    id: 'ocd-020',
    orderNumber: '202510110021',
    status: '进行中',
    subcontractor: '宏达制衣',
    styleNumber: 'SK7251',
    styleName: '都市修身西装裙',
    color: '暮紫',
    size: 'M',
    unitPrice: 18.2,
    cuttingDate: '2025-10-14',
    quantity: 26,
  },
];

const detailRecords: OutsourcingCuttingDetailRecord[] = detailSeeds.map((seed) => ({
  ...seed,
  amount: Number((seed.unitPrice * seed.quantity).toFixed(2)),
}));

const listTotal = detailRecords.length;
const listSummary = detailRecords.reduce(
  (acc, record) => {
    acc.quantity += record.quantity;
    acc.amount += record.amount;
    return acc;
  },
  { quantity: 0, amount: 0 },
);

export const fetchOutsourcingCuttingDetailList = async (
  params: OutsourcingCuttingDetailListParams,
  latency = 280,
): Promise<OutsourcingCuttingDetailListResponse> => {
  await delay(latency);
  const page = Math.max(params.page, 1);
  const pageSize = Math.max(params.pageSize, 1);
  const start = (page - 1) * pageSize;
  const list = detailRecords.slice(start, start + pageSize);
  return {
    list,
    total: listTotal,
    summary: listSummary,
  };
};
